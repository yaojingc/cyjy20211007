{"version":3,"sources":["webpack://[name]/./src/platform/containers/DagreChart/Component.js","webpack://[name]/./src/platform/containers/DagreChart/method.js","webpack://[name]/./node_modules/_@antv_g6@2.1.0@@antv/g6/build/plugin.tool.tooltip.js"],"names":["G6","require","G6Plugins","track","DagreChart","props","getDrawDagreData","list","data","nodes","edges","forEach","item","push","createEdges","setState","extract","renderDagre","changeColor","state","renderShape","shape","registerNode","getPath","Util","getRectPath","initDagre","tooltipText","dagre","rankdir","nodesep","ranksep","tooltip","Plugins","getTooltip","model","getModel","title","billTypeName","billcode","billCode","tips","graph","Graph","id","heigth","plugins","defaultIntersectBox","modes","default","edge","style","endArrow","label","size","node","stroke","itemClickEvent","on","wheelScrollZoom","getZoom","calculaterGraphPosition","sourceArr","graphColumnCount","graphRowCount","length","val","source","target","lenArr","itemArr","sort","a","b","graphWidth","graphHeight","dagreScrollWrap","document","querySelector","firstRender","dagreScrollWrapHeight","clientHeight","dagreScrollWrapWidth","clientWidth","dy","dx","translate","firstChangeZoom","dragNodeChangePostion","read","currentZoom","zoom","ev","isNode","selectedId","getSelectId","relatedData","type","find","elem","transtype","onSelect","color","relatedData1","getRelated","relatedData2","fill","handleClick","extractTip","content","calculatePostionbBeforeRender","setTimeout","dagreScrollHeight","dagreScrollWidth","dagreScrollH","hasTableDy","dy2","prevDy","zoomX","zoomY","dagreScrollW","this","parentCom","nextProps","undefined","extractBtns","btnTitle","className","height","NCButton","fieldid","onClick","width","Component","flowFormatNode","map","index","act_id","text","name","act_name","isForward","sourceEdges","targetEdges","x","y","update","generateInitSelected","filter","ispassroute","equalArray","arr1","arr2","Object","prototype","toString","call","slice","JSON","stringify","keyNodeId","sources","targets","getSource","sourceIds","getTargets","targetIds","Set","nodeIds","ele","t","window","module","exports","o","e","n","i","l","m","c","d","defineProperty","enumerable","get","r","Symbol","toStringTag","value","__esModule","create","bind","hasOwnProperty","p","s","133","assign","arguments","TypeError","options","isArray","init","onMouseEnter","onMouseMove","onMouseLeave","getGraphContainer","destroy","createDOM","css","position","appendChild","domX","domY","getOuterWidth","getOuterHeight","getWidth","u","getHeight","top","_getTop","left","_getLeft","3"],"mappings":"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","file":"DagreChart.js","sourcesContent":["// 单据追溯图表\nimport React, { Component } from 'react';\nimport { NCButton } from '../../base';\nimport toast from '../../api/toast';\nimport { createEdges, dragNodeChangePostion, getRelated } from './method';\nimport '@antv/g6/build/plugin.tool.tooltip';\n\nconst G6 = require('@antv/g6');\nconst G6Plugins = require('@antv/g6/build/plugins');\n// import '@antv/g6/build/plugin.behaviour.analysis';\nG6.track(false);\nexport default class DagreChart extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tdata: {\n\t\t\t\tnodes: this.props.list,\n\t\t\t\tedges: createEdges(this.props.list)\n\t\t\t}, // 节点和线条数据\n\t\t\tselectedId: this.props.selectedId || '', // 选中的节点id，页面初加载时选中节点为基本节点,即基于基本节点构建的上下游关系\n\t\t\textract: false, // 是否是路径抽取状态\n\t\t\trelatedData: null, // 抽取路径后相关联的节点数据，用来渲染路径抽取视图\n\t\t\tgraphHeight: 0, //流程图大于整个可视区的时候，图的高度\n\t\t\tgraphWidth: 0, //流程图大于整个可视区的时候，图的宽度\n\t\t\twheelScrollZoom: null //滚动鼠标滚轮之后的缩放比例\n\t\t};\n\t\tthis.dagre = null; //流程图\n\t\tthis.tooltip = null; //节点悬浮内容提示\n\t\tthis.graph = null;\n\t\tthis.currentZoom = null; //渲染前的画布比例\n\t\tthis.firstRender = true;\n\t\tthis.dagreScrollH = null; //dagreScroll的高度\n\t\tthis.dagreScrollW = null; //dagreScroll的宽度\n\t\tthis.dagreScrollWrapHeight = 0;\n\t\tthis.dagreScrollWrapWidth = 0;\n\t\tthis.firstChangeZoom = false; //打开单据追溯弹框之后，第一次渲染流程图的时候计算zoom，之后不计算\n\t\tthis.hasTableDy = null; //显示隐藏表格的时候，值计算一次位移，在流程图小于可视区的时候，在显示表格的时候高度居中\n\t\tthis.prevDy = null; //流程图前一次计算的Y轴的位移，是对应modal的body上边而言\n\t}\n\n\tcomponentWillMount() {\n\t\tlet { list, parentCom } = this.props;\n\t\tif (parentCom !== 'BillTrack') {\n\t\t\t//父组件不是单据追溯的时候，初始化接收渲染图的数据\n\t\t\tthis.getDrawDagreData(list);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tlet { getSelectId } = this.props;\n\t\tthis.initDagre();\n\t\tif (getSelectId && typeof getSelectId === 'function') {\n\t\t\tgetSelectId(this.state.selectedId);\n\t\t}\n\t\t// let modalBody = document.querySelector('.u-modal-bill-track-body');\n\t\t// if (modalBody) {\n\t\t// \tmodalBody.style.minHeight = modalBody.clientHeight + 'px';\n\t\t// \tmodalBody.style.minWidth = modalBody.clientWidth + 'px';\n\t\t// }\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tlet { list, size } = nextProps;\n\t\tthis.getDrawDagreData(list);\n\t\tif (size !== undefined && size !== this.props.size) {\n\t\t\tif (size == true) {\n\t\t\t\t//隐藏表格 图下移\n\t\t\t\tthis.graph.translate(0, -this.prevDy);\n\t\t\t} else {\n\t\t\t\t//显示表格 图上移\n\t\t\t\tthis.graph.translate(0, this.prevDy);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**接收渲染图的数据\n\t * list:array 是BIltrack的index.js中的dataFormat方法返回的数组\n\t */\n\tgetDrawDagreData = list => {\n\t\tlet data = {\n\t\t\tnodes: list,\n\t\t\tedges: []\n\t\t};\n\t\tlist.forEach(item => data.edges.push(...createEdges(item)));\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tdata,\n\t\t\t\textract: false\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.renderDagre(this.changeColor(this.state.data));\n\t\t\t}\n\t\t);\n\t};\n\n\trenderShape = (G6, shape) => {\n\t\tif (shape === 'react') {\n\t\t\treturn G6.registerNode('rect', {\n\t\t\t\tgetPath: function getPath() {\n\t\t\t\t\tvar width = 136; // 一半宽\n\t\t\t\t\tvar height = 50; // 一半高\n\t\t\t\t\treturn G6.Util.getRectPath(-width / 2, -height / 2, width, height, 10);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\t/**初始化渲染并绑定节点事件\n\t * tooltipText:Array 流程图节点悬停的气泡提示中文\n\t */\n\tinitDagre = () => {\n\t\tlet { tooltipText } = this.props;\n\t\tthis.renderShape(G6, 'react');\n\t\tthis.dagre = new G6Plugins['layout.dagre']({\n\t\t\trankdir: 'LR', // 左右方向\n\t\t\tnodesep: 30, // 节点间距\n\t\t\tranksep: 30 // 层级间距\n\t\t});\n\t\tthis.tooltip = new G6.Plugins['tool.tooltip']({\n\t\t\t//每个节点的气泡提示\n\t\t\tgetTooltip({ item }) {\n\t\t\t\tconst model = item.getModel();\n\t\t\t\tif (model) {\n\t\t\t\t\tlet title = model.billTypeName;\n\t\t\t\t\tlet billcode = model.billCode;\n\t\t\t\t\tlet nameLabel = tooltipText && tooltipText[0] ? tooltipText[0] : '单据名称-1';\n\t\t\t\t\tlet codeLabel = tooltipText && tooltipText[1] ? tooltipText[1] : '单据编号-1';\n\t\t\t\t\tlet tips = `<ul class=\"dagre-toolTip\">\n\t\t\t\t\t\t\t\t<li class=\"dagre-toolTip-title\">${nameLabel}: ${title}</li>\n\t\t\t\t\t\t\t\t<li class=\"dagre-toolTip-billcode\">${codeLabel}: ${billcode}</li>\n\t\t\t\t\t\t\t</ul>`;\n\t\t\t\t\treturn tips;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.graph = new G6.Graph({\n\t\t\tid: 'mountNode', //dom Id\n\t\t\theigth: 250, // 网格的高度(不太管用，需进一步验证)\n\t\t\tplugins: [this.dagre, this.tooltip],\n\t\t\tdefaultIntersectBox: 'rect', // 使用矩形包围盒\n\t\t\tmodes: {\n\t\t\t\tdefault: ['panBlank', 'panNode', 'wheelZoom']\n\t\t\t}\n\t\t});\n\t\t//流程线条箭头设置\n\t\tthis.graph.edge({\n\t\t\tstyle: {\n\t\t\t\tendArrow: true\n\t\t\t},\n\t\t\tlabel(model) {\n\t\t\t\treturn model.shape;\n\t\t\t},\n\t\t\tsize: 1\n\t\t});\n\n\t\tthis.graph.node({\n\t\t\tshape: 'rect',\n\t\t\tstyle: {\n\t\t\t\tstroke: '#CCEAFF'\n\t\t\t}\n\t\t});\n\t\tthis.itemClickEvent();\n\t\tthis.graph.on('wheel', () => {\n\t\t\tlet wheelScrollZoom = this.graph.getZoom();\n\t\t\tthis.setState({\n\t\t\t\twheelScrollZoom\n\t\t\t});\n\t\t});\n\t};\n\n\t//计算流程图的宽高，用途：让流程图居中显示 g6没有这个功能的API\n\tcalculaterGraphPosition = data => {\n\t\tlet graph = this.graph;\n\t\t/*\n\t\tsourceArr是节点sourceList和targetList的集合，数据套数据[[],[],...],\n\t\t流程图的列数graphColumnCount是sourceArr的长度加一，\n\t\t流程图的行数graphRowCount是sourceArr的子项最长一项的长度，\n\t\t */\n\t\tlet sourceArr = [];\n\t\tlet graphColumnCount = 0;\n\t\tlet graphRowCount = 0;\n\t\tif (data.nodes.length > 1) {\n\t\t\t//流程图有多个节点的时候\n\t\t\tdata.nodes.forEach(val => {\n\t\t\t\tif (val.source.length) {\n\t\t\t\t\tsourceArr.push(val.source);\n\t\t\t\t}\n\t\t\t\tif (val.target.length) {\n\t\t\t\t\tsourceArr.push(val.target);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (sourceArr.length) {\n\t\t\t\tgraphColumnCount = sourceArr.length + 1;\n\t\t\t\tlet lenArr = [];\n\t\t\t\tsourceArr.forEach((itemArr) => {\n\t\t\t\t\tlenArr.push(itemArr.length);\n\t\t\t\t});\n\t\t\t\tlenArr.sort((a, b) => b - a);\n\t\t\t\tgraphRowCount = lenArr[0];\n\n\t\t\t\tlet graphWidth = graphColumnCount * 136 + (graphColumnCount - 1) * 30;\n\t\t\t\tlet graphHeight = graphRowCount * 50 + (graphRowCount - 1) * 30;\n\n\t\t\t\tlet dagreScrollWrap = document.querySelector('.dagreScrollWrap');\n\t\t\t\tif (dagreScrollWrap && this.firstRender) {\n\t\t\t\t\tlet dagreScrollWrapHeight = dagreScrollWrap.clientHeight;\n\t\t\t\t\tlet dagreScrollWrapWidth = dagreScrollWrap.clientWidth;\n\t\t\t\t\tthis.dagreScrollWrapHeight = dagreScrollWrapHeight;\n\t\t\t\t\tthis.dagreScrollWrapWidth = dagreScrollWrapWidth;\n\n\t\t\t\t\tlet dy = (dagreScrollWrapHeight - graphHeight) / 2;\n\t\t\t\t\tlet dx = (dagreScrollWrapWidth - graphWidth) / 2;\n\t\t\t\t\tif (this.dagreScrollWrapHeight) {\n\t\t\t\t\t\tif (dx >= 0 && dy >= 0) {\n\t\t\t\t\t\t\tgraph.translate(dx, dy);\n\t\t\t\t\t\t} else if (dx >= 0 && dy <= 0) {\n\t\t\t\t\t\t\tgraph.translate(dx, 0);\n\t\t\t\t\t\t} else if (dy >= 0 && dx <= 0) {\n\t\t\t\t\t\t\tgraph.translate(0, dy);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tgraphWidth,\n\t\t\t\t\t\t\tgraphHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.firstChangeZoom = true;\n\t\t\t\t\t\tthis.firstRender = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (data.nodes.length === 1) {\n\t\t\t//只有一个节点的时候\n\t\t\tlet dagreScrollWrap = document.querySelector('.dagreScrollWrap');\n\t\t\tif (dagreScrollWrap && this.firstRender) {\n\t\t\t\tlet dagreScrollWrapHeight = dagreScrollWrap.clientHeight;\n\t\t\t\tlet dagreScrollWrapWidth = dagreScrollWrap.clientWidth;\n\t\t\t\tthis.dagreScrollWrapHeight = dagreScrollWrapHeight;\n\t\t\t\tthis.dagreScrollWrapWidth = dagreScrollWrapWidth;\n\t\t\t\tlet dy = (dagreScrollWrapHeight - 50) / 2;\n\t\t\t\tlet dx = (dagreScrollWrapWidth - 136) / 2;\n\t\t\t\tgraph.translate(dx, dy);\n\t\t\t\tthis.setState({\n\t\t\t\t\tgraphWidth: 136,\n\t\t\t\t\tgraphHeight: 50\n\t\t\t\t});\n\t\t\t\tthis.firstRender = false;\n\t\t\t\tthis.firstChangeZoom = true;\n\t\t\t}\n\t\t}\n\t};\n\n\t// 渲染关系图\n\trenderDagre = data => {\n\t\t//渲染出流程图会走两次这个方法\n\t\tthis.calculaterGraphPosition(data);\n\n\t\tlet graph = this.graph;\n\t\tdragNodeChangePostion(graph);\n\t\tgraph.read(data); //把绘制流程图的数据传进去\n\t\tif (graph && this.currentZoom) {\n\t\t\t//图方法之后点击，保持点击前的大小\n\t\t\tgraph.zoom(this.currentZoom);\n\t\t}\n\t};\n\n\t// 节点的点击事件\n\titemClickEvent = () => {\n\t\tthis.graph.on('click', ev => {\n\t\t\tif (ev.item && ev.item.isNode) {\n\t\t\t\tlet selectedId = ev.item.id;\n\t\t\t\tif (selectedId !== this.state.selectedId) {\n\t\t\t\t\tthis.setState({ selectedId }, () => {\n\t\t\t\t\t\tthis.props.getSelectId && this.props.getSelectId(selectedId);\n\t\t\t\t\t});\n\t\t\t\t\tif (this.state.extract) {\n\t\t\t\t\t\tlet data = this.changeColor(this.state.relatedData);\n\t\t\t\t\t\tthis.setState({ relatedData: data }, () => this.renderDagre(data));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet data = this.changeColor(this.state.data);\n\t\t\t\t\t\tthis.setState({ data }, () => this.renderDagre(data));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.graph.on('dblclick', ev => {\n\t\t\tif (ev.item && ev.item.type === 'node') {\n\t\t\t\tlet selectedId = ev.item.model.id;\n\t\t\t\tlet type = this.state.data.nodes.find(elem => {\n\t\t\t\t\treturn elem.id == selectedId;\n\t\t\t\t}).type;\n\t\t\t\tlet transtype = this.state.data.nodes.find(elem => {\n\t\t\t\t\treturn elem.id == selectedId;\n\t\t\t\t}).transtype;\n\t\t\t\tthis.props.onSelect && this.props.onSelect(selectedId, type, transtype);\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * 改变选中节点的颜色\n\t */\n\tchangeColor = data => {\n\t\tthis.currentZoom = this.graph.getZoom();\n\t\tdata.nodes.forEach(item => {\n\t\t\tif (item && item.color) {\n\t\t\t\titem.color = '#fff';\n\t\t\t}\n\t\t});\n\t\tdata.edges.forEach(item => {\n\t\t\tif (item && item.color) {\n\t\t\t\titem.color = '#888';\n\t\t\t}\n\t\t});\n\t\tlet { selectedId, extract, relatedData } = this.state;\n\t\tif (selectedId) {\n\t\t\tlet relatedData1 = getRelated(selectedId, this.state.data); // 未抽取视图的相关联数据\n\t\t\tlet relatedData2 = extract ? getRelated(selectedId, relatedData) : { nodes: [], edges: [] }; // 抽取路径后视图的相关联数据\n\t\t\tlet nodes = [...relatedData1.nodes, ...relatedData2.nodes];\n\t\t\tlet edges = [...relatedData1.edges, ...relatedData2.edges];\n\t\t\tif (nodes) {\n\t\t\t\tnodes.forEach(item => {\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\tif (item.id === this.state.selectedId) {\n\t\t\t\t\t\t\tif (item.label && item.label.fill) {\n\t\t\t\t\t\t\t\titem.label.fill = '#007ACE';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem.color = '#CCEAFF';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (item.label && item.label.fill) {\n\t\t\t\t\t\t\t\titem.label.fill = '#F87321';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titem.color = '#FFE19D';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tedges.forEach(item => {\n\t\t\t\t\tif (item && item.color) {\n\t\t\t\t\t\titem.color = 'green';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t};\n\n\t// 抽取路径按钮的点击事件\n\thandleClick = () => {\n\t\tlet { extractTip } = this.props;\n\t\tif (!this.state.extract) {\n\t\t\tif (this.state.selectedId) {\n\t\t\t\tthis.setState(\n\t\t\t\t\t{\n\t\t\t\t\t\textract: !this.state.extract,\n\t\t\t\t\t\trelatedData: getRelated(this.state.selectedId, this.state.data)\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\tlet data = this.changeColor(this.state.relatedData);\n\t\t\t\t\t\tthis.renderDagre(data);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttoast({ color: 'warning', content: extractTip });\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\textract: !this.state.extract\n\t\t\t});\n\t\t\tthis.renderDagre(this.state.data);\n\t\t}\n\t};\n\n\t//每次流程图渲染的时候，让图中部居中\n\tcalculatePostionbBeforeRender = size => {\n\t\tlet { graphHeight, graphWidth, wheelScrollZoom } = this.state;\n\t\tsetTimeout(() => {\n\t\t\tlet dagreScrollWrap = document.querySelector('.dagreScrollWrap');\n\t\t\tif (dagreScrollWrap) {\n\t\t\t\tlet dagreScrollHeight = dagreScrollWrap.clientHeight;\n\t\t\t\tlet dagreScrollWidth = dagreScrollWrap.clientWidth;\n\n\t\t\t\tif (dagreScrollHeight - graphHeight >= 0) {\n\t\t\t\t\t//显示表格，且流程图高度小于于可视区\n\t\t\t\t\tif (!this.dagreScrollH) {\n\t\t\t\t\t\tthis.dagreScrollH = dagreScrollHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (graphHeight) {\n\t\t\t\t\t\t\tif (size === false) {\n\t\t\t\t\t\t\t\t//显示表格的时候\n\t\t\t\t\t\t\t\tif (!this.hasTableDy) {\n\t\t\t\t\t\t\t\t\tlet dy2 = (dagreScrollHeight - graphHeight) / 2;\n\t\t\t\t\t\t\t\t\tlet dy1 = (dagreScrollHeight - graphHeight) / 2;\n\t\t\t\t\t\t\t\t\tlet dy = dy2 - dy1;\n\t\t\t\t\t\t\t\t\tthis.hasTableDy = dy2;\n\t\t\t\t\t\t\t\t\tthis.graph.translate(0, dy);\n\t\t\t\t\t\t\t\t\tthis.prevDy = dy;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (dagreScrollHeight - graphHeight < 0) {\n\t\t\t\t\t//流程图高度大于可视区\n\t\t\t\t\tif (dagreScrollHeight) {\n\t\t\t\t\t\tthis.dagreScrollH = graphHeight;\n\t\t\t\t\t\tif (this.firstChangeZoom) {\n\t\t\t\t\t\t\t//在流程图的宽高大于dagreScrollWrap宽高的时候，缩放比例按照差值更多的一方来计算\n\t\t\t\t\t\t\tthis.firstChangeZoom = false;\n\t\t\t\t\t\t\tlet zoomX = dagreScrollWidth / graphWidth;\n\t\t\t\t\t\t\tlet zoomY = dagreScrollHeight / graphHeight;\n\t\t\t\t\t\t\tif (zoomX < zoomY) {\n\t\t\t\t\t\t\t\tthis.currentZoom = zoomX;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.currentZoom = zoomY;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (wheelScrollZoom) {\n\t\t\t\t\t\t\t\tthis.graph.zoom(wheelScrollZoom);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.graph.zoom(this.currentZoom);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (dagreScrollWidth - graphWidth >= 0) {\n\t\t\t\t\t//流程图宽度小于可视区\n\t\t\t\t\tif (!this.dagreScrollW) {\n\t\t\t\t\t\tthis.dagreScrollW = dagreScrollWidth;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!this.dagreScrollW) {\n\t\t\t\t\t\tthis.dagreScrollH = graphWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 50);\n\t};\n\n\trender() {\n\t\t//size 表格是否显示的控制参数 Boolean  默认是false不显示表格 true是显示表格\n\t\tlet { size, extractBtns } = this.props;\n\n\t\tlet btnTitle;\n\t\tif (extractBtns) {\n\t\t\tbtnTitle = this.state.extract ? extractBtns[0] : extractBtns[1];\n\t\t}\n\t\tthis.calculatePostionbBeforeRender(size);\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={`${this.props.className ? this.props.className : ''} dagre-area `}\n\t\t\t\tstyle={{ height: `${size ? '96%' : '50%'}` }}\n\t\t\t>\n\t\t\t\t{btnTitle && (\n\t\t\t\t\t<NCButton\n\t\t\t\t\t\tclassName=\"button-primary dagre-extract\"\n\t\t\t\t\t\tfieldid={this.state.extract ? 'show-all' : 'dagre-extract'}\n\t\t\t\t\t\tonClick={this.handleClick}\n\t\t\t\t\t>\n\t\t\t\t\t\t{btnTitle}\n\t\t\t\t\t</NCButton>\n\t\t\t\t)}\n\t\t\t\t<div className=\"dagreScrollWrap\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"dagreScroll\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t//单据追溯点击节点，数据量大时会出现模糊现象，先这样修改，有问题再说\n\t\t\t\t\t\t\theight: `${'100%'}`,\n\t\t\t\t\t\t\twidth: `${'100%'}`\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div id=\"mountNode\" className=\"dagre\" style={{ width: '100%' }} />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","/**\n * 节点信息生成\n * **/\nconst flowFormatNode = (data) => {\n    return data.map( (item, index) => {\n        return {\n            id: item.act_id,\n\t\t\tlabel:{     \n\t\t\t\ttext: item.label\n\t\t\t},\n            name: item.act_name,\n        }\n    })\n}\n\n/**\n * 流程节点关系数组生成\n * **/\nconst createEdges = (node) => {\n    switch (node.isForward) {\n        case '0':\n            // 0表示节点是当前节点，当前节点找上下游\n            let sourceEdges = node.source.map((item) => {\n                return { source: item, target: node.id };\n            });\n            let targetEdges = node.target.map((item) => {\n                return { source: node.id, target: item };\n            });\n            return [ ...sourceEdges, ...targetEdges ];\n            break;\n        case '1':\n            // 1表示下游节点，下游节点找下游\n            return node.target.map((item) => {\n                return { source: node.id, target: item };\n            });\n            break;\n        case '-1':\n            // -1表示上游节点，上游节点找上游\n            return node.source.map((item) => {\n                return { source: item, target: node.id };\n            });\n            break;\n        default:\n            return [];\n            break;\n    }\n};\n/**\n * 节点简单拖拽位置变化\n * **/\nconst dragNodeChangePostion = (graph) => {\n    let node;\n    let dx;\n    let dy;\n    graph.on('node:dragstart', ev=>{\n      const {item} = ev;\n      const model = item.getModel();\n      node = item;\n      dx = model.x - ev.x;\n      dy = model.y - ev.y;\n    });\n    graph.on('node:drag', ev=>{\n      node && graph.update(node, {\n        x: ev.x+dx,\n        y: ev.y+dy\n      });\n    });\n    graph.on('node:dragend', ev=>{\n      node = undefined;\n    });\n}\n\n/**\n * 生成初始化的当前所属节点\n * **/\nconst generateInitSelected = (data) => {\n    return data.filter( (item, index) => {\n        return item.ispassroute\n    })\n}\n\n/**\n * 判断两个对象数组是否相等 【升级之后没有用的】\n * **/\nconst equalArray = (arr1, arr2) => {\n    if(!arr1 || !arr2) return false;\n    if(Object.prototype.toString.call(arr1).slice(8, -1) !== 'Array' || Object.prototype.toString.call(arr2).slice(8, -1) !== 'Array') return false; \n    return JSON.stringify(arr1) === JSON.stringify(arr2)\n}\n\n/**\n * 查找上下游的节点和路径 参数data: 查找相关数据的原始数据范围\n */\nconst getRelated = (keyNodeId, data) => {\n\t\tlet edges = [];\n\t\tlet sources = [];\n\t\tlet targets = [];\n\t\tlet getSource = (id) => {\n\t\t\tlet sourceEdges = data.edges.filter(({ target }) => target === id);\n\t\t\tlet sourceIds = sourceEdges.map((item) => item.source);\n\t\t\tedges.push(...sourceEdges);\n\t\t\tsources.push(...sourceIds);\n\t\t\tif (sourceIds.length > 0) {\n\t\t\t\tsourceIds.forEach((item) => getSource(item));\n\t\t\t}\n\t\t};\n\t\tlet getTargets = (id) => {\n\t\t\tlet targetEdges = data.edges.filter(({ source }) => source === id);\n\t\t\tlet targetIds = targetEdges.map((item) => item.target);\n\t\t\tedges.push(...targetEdges);\n\t\t\ttargets.push(...targetIds);\n\t\t\tif (targetIds.length > 0) {\n\t\t\t\ttargetIds.forEach((item) => getTargets(item));\n\t\t\t}\n\t\t};\n\t\tgetSource(keyNodeId);\n\t\tgetTargets(keyNodeId);\n\t\tedges = [ ...new Set(edges) ];\n\t\tlet nodeIds = [ ...new Set([ ...sources, keyNodeId, ...targets ]) ]; // 用 Set 去重\n\t\tlet nodes = nodeIds.map((item) => {\n\t\t\treturn data.nodes.find((ele) => ele.id === item);\n\t\t});\n\t\treturn {\n\t\t\tedges,\n\t\t\tnodes\n\t\t};\n\t};\nexport {\n    flowFormatNode,\n    createEdges,\n    dragNodeChangePostion,\n    generateInitSelected,\n    equalArray,\n    getRelated\n}","!function(t,o){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=o(require(\"@antv/g6\")):\"function\"==typeof define&&define.amd?define([\"@antv/g6\"],o):\"object\"==typeof exports?exports[\"plugin.tool.tooltip\"]=o(require(\"@antv/g6\")):t[\"plugin.tool.tooltip\"]=o(t.G6)}(window,function(t){return function(t){var o={};function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:n})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&o&&\"string\"!=typeof t)for(var i in t)e.d(n,i,function(o){return t[o]}.bind(null,i));return n},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,\"a\",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p=\"\",e(e.s=133)}({133:function(t,o,e){var n=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t};var i=e(3),r=i.Util,p=function(){function t(o){!function(t,o){if(!(t instanceof o))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.options=n({dx:10,dy:10,getTooltip:function(t){var o=t.item;if(o){var e=o.getModel().tooltip;if(e){var n=\"\",i=o.type;return r.isArray(e)?e.forEach(function(t){n+='<li style=\"font-size: 12px;list-style-type: none;\"><span>'+t[0]+\"</span>: \"+t[1]+\"</li>\"}):(i=e.title,e.list.forEach(function(t){n+='<li style=\"font-size: 12px;list-style-type: none;\"><span>'+t[0]+\"</span>: \"+t[1]+\"</li>\"})),'\\n              <div class=\"g6-tooltip\" style=\"\\n                position: absolute;\\n                white-space: nowrap;\\n                zIndex: 8;\\n                transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1);\\n                background-color: rgba(255, 255, 255, 0.9);\\n                box-shadow: 0px 0px 10px #aeaeae;\\n                border-radius: 3px;\\n                color: rgb(87, 87, 87);\\n                line-height: 20px;\\n                padding: 10px 10px 6px 10px;\\n              \">\\n                <h4 class=\"g6-tooltip-title\" style=\"\\n                  margin: 0;\\n                \">'+i+'</h4>\\n                <ul class=\"g6-tooltip-list\" style=\"\\n                  padding: 0;\\n                  margin: 0;\\n                  margin-top: 4px;\\n                \">\\n                  '+n+\"\\n                </ul>\\n              </div>\\n            \"}}return null}},o)}return t.prototype.init=function(){var t=this,o=this.graph;o.on(\"mouseenter\",function(o){o.shape&&t.onMouseEnter(o)}),o.on(\"mousemove\",function(o){t.onMouseMove(o)}),o.on(\"mouseleave\",function(o){t.onMouseLeave(o)})},t.prototype.onMouseEnter=function(t){var o=this.graph.getGraphContainer(),e=this.options.getTooltip(t),n=this.tooltip;n&&this.tooltip.destroy(),e?((n=r.createDOM(e)).css({position:\"absolute\"}),o.appendChild(n)):n=null,this.tooltip=n},t.prototype.onMouseMove=function(t){var o=t.domX,e=t.domY,n=this.tooltip;if(n){var i=this.graph,p=r.getOuterWidth(n),s=r.getOuterHeight(n),l=i.getWidth(),u=i.getHeight();n.css({top:this._getTop(s,u,e),left:this._getLeft(p,l,o)})}},t.prototype.onMouseLeave=function(){this.tooltip&&(this.tooltip.destroy(),this.tooltip=null)},t.prototype._getTop=function(t,o,e){var n=this.options.dy;return 2*t>=o?\"0px\":e<t+n?e+n+\"px\":e-t-n+\"px\"},t.prototype._getLeft=function(t,o,e){var n=this.options.dx;return 2*t>=o?\"0px\":o-e-n<t?e-t-n+\"px\":e+n+\"px\"},t.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy()},t}();i.Plugins[\"tool.tooltip\"]=p,t.exports=p},3:function(o,e){o.exports=t}})});\n//# sourceMappingURL=plugin.tool.tooltip.js.map"],"sourceRoot":""}